#!/usr/bin/env ruby

puts "TIC TAC TOE game!!"

player_1 = Hash.new
player_2 = Hash.new

print "First player name: "

player_1[:name] = gets.chomp.capitalize

print "Second player name: "

player_2[:name] = gets.chomp.capitalize

$board = [1, 2, 3, 4, 5, 6, 7, 8, 9]

def board_show
    puts "=================="
    puts "|| #{$board[0]} || #{$board[1]} || #{$board[2]} ||"
    puts "=================="
    puts "|| #{$board[3]} || #{$board[4]} || #{$board[5]} ||"
    puts "=================="
    puts "|| #{$board[6]} || #{$board[7]} || #{$board[8]} ||"
    puts "=================="
end

board_show

loop do
    puts "#{player_1[:name]} choose your sign( X - O):"
    player_1[:sign] = gets.chomp.upcase!
    player_1[:sign] == "X" ? player_2[:sign] = "O" : player_2[:sign] = "X"
    break if player_1[:sign] == "X" || player_1[:sign] == "O"
    puts "Incorrect input!"
end

puts "#{player_1[:name]} sign's: #{player_1[:sign]}"
puts "#{player_2[:name]} sign's: #{player_2[:sign]}"

def game_finish?
    if ($board[0] == $board[1])&&($board[1] == $board[2])
        return true
    elsif ($board[3] == $board[4])&&($board[4] == $board[5])
        return true
    elsif ($board[6] == $board[7])&&($board[7] == $board[8])
        return true
    elsif ($board[0] == $board[3])&&($board[3] == $board[6])
        return true
    elsif ($board[1] == $board[4])&&($board[4] == $board[7])
        return true
    elsif ($board[2] == $board[5])&&($board[5] == $board[8])
        return true
    elsif ($board[0] == $board[4])&&($board[4] == $board[8])
        return true
    elsif ($board[2] == $board[4])&&($board[4] == $board[6])
        return true
    elsif $board.all?(String)
        draw = "yes"
        return true
    end
end

draw = "no"
loop do
    board_show
    loop do
        puts "#{player_1[:name]}, make a move choosing a number"
        player_1[:move] = gets.chomp
        if $board[player_1[:move].to_i - 1].is_a? Integer
            $board[player_1[:move].to_i - 1] = player_1[:sign]
            break 
        else
            puts "Position already taken! Choose again!"
        end
    end
    board_show
    game_checker = game_finish?
    break if game_checker
    loop do
        puts "#{player_2[:name]}, make a move choosing a number"
        player_2[:move] = gets.chomp
        if $board[player_2[:move].to_i - 1].is_a? Integer
            $board[player_2[:move].to_i - 1] = player_2[:sign]
            break 
        else
            puts "Position already taken! Choose again!"
        end
    end
    game_checker = game_finish?
    board_show
    break if game_checker
end

# Game continue until someone wins
puts "Congratulations! #player_winner wins (or it's a draw)! Want to play again?"
puts "Choose Y to play again and N to exit the game"